var documenterSearchIndex = {"docs":
[{"location":"user_guide/#User-Guide","page":"Home","title":"User Guide","text":"This guide provides detailed instructions on how to use the Synthetic Tomographic Data Generation repository.","category":"section"},{"location":"user_guide/#Table-of-Contents","page":"Home","title":"Table of Contents","text":"Prerequisites & Installation\nRepository Structure\nRunning the Simulations\nCan Phantom\nIonic Chamber Phantom\nConfiguration\nCommand Line Arguments\nJSON Configuration\nTesting & Verification\nOutput Artifacts\nEnvironment Setup\nTroubleshooting\n\n","category":"section"},{"location":"user_guide/#Environment-Setup","page":"Home","title":"Environment Setup","text":"You can set up the environment using either Docker (recommended for consistency) or a manual local installation.","category":"section"},{"location":"user_guide/#Option-1:-Using-Docker-/-Dev-Container-(Recommended)","page":"Home","title":"Option 1: Using Docker / Dev Container (Recommended)","text":"This repository includes a Dockerfile and Dev Container configuration, making it easy to get started with a pre-configured environment that includes all Julia and Python dependencies, as well as system tools like nii2dcm and gcloud.","category":"section"},{"location":"user_guide/#Using-VS-Code-Dev-Containers","page":"Home","title":"Using VS Code Dev Containers","text":"Open the repository in VS Code.\nInstall the Dev Containers extension.\nWhen prompted \"Reopen in Container\", select Reopen.\nVS Code will build the Docker image and start the container. This may take a few minutes.\nOnce inside, all tools (julia, python, nii2dcm) are available in the terminal.","category":"section"},{"location":"user_guide/#Manual-Docker-Build","page":"Home","title":"Manual Docker Build","text":"If you prefer to run the Docker container manually:\n\nBuild the image:  bash  docker build -t synthetic-tomo .\nRun the container:  bash  docker run -it --rm -v $(pwd):/workspace synthetic-tomo /bin/bash  Note: The Dockerfile sets the working directory to /root/.devcontainer. You might want to navigate to /workspace or wherever you mounted your code.","category":"section"},{"location":"user_guide/#Option-2:-Manual-Local-Setup","page":"Home","title":"Option 2: Manual Local Setup","text":"If you cannot use Docker, follow these steps to set up the environment on your local machine (Linux/macOS recommended).","category":"section"},{"location":"user_guide/#1.-System-Requirements","page":"Home","title":"1. System Requirements","text":"Julia: Install Julia v1.10 or later from julialang.org.\nPython: Install Python 3.10 or later.\nGoogle Cloud SDK: Install gcloud CLI if you intend to upload results.\nDICOM Tools (Optional): Install nii2dcm if you need DICOM output.\nNote: The Dockerfile builds nii2dcm from source (https://github.com/tomaroberts/nii2dcm), but standard dcmtk tools might also be sufficient depending on your needs.","category":"section"},{"location":"user_guide/#2.-Python-Environment","page":"Home","title":"2. Python Environment","text":"Create a virtual environment to isolate dependencies:\n\n# Create and activate virtual environment\npython3 -m venv venv\nsource venv/bin/activate\n\n# Install required packages\npip install SimpleITK wandb adrt h5py scikit-image pydicom nibabel matplotlib numpy==1.23.2\n\nNote: numpy version is pinned in Dockerfile to 1.23.2, but newer versions may work depending on adrt compatibility.","category":"section"},{"location":"user_guide/#3.-Julia-Environment","page":"Home","title":"3. Julia Environment","text":"Install the required Julia packages. A setup script is provided for convenience:\n\n# Run the setup script\njulia tests/setup_env.jl\n\nManual Julia Setup details: The ImagePhantoms package must be installed from a specific Git repository, not the general registry.\n\nusing Pkg\n# Install custom ImagePhantoms\nPkg.add(url=\"https://github.com/jakubMitura14/ImagePhantoms.jl.git\")\n\n# Install registered packages\nPkg.add([\n    \"Meshes\", \"ImageFiltering\", \"Accessors\", \"UUIDs\", \"JSON\", \"HDF5\",\n    \"MIRTjim\", \"ImageGeoms\", \"Sinograms\", \"PyCall\", \"FFTW\", \"LazyGrids\",\n    \"Unitful\", \"Plots\", \"Revise\"\n])","category":"section"},{"location":"user_guide/#4.-Verification","page":"Home","title":"4. Verification","text":"Run the small test suite to ensure everything is configured correctly:\n\njulia tests/run_tests_small.jl\n\n","category":"section"},{"location":"user_guide/#Repository-Structure","page":"Home","title":"Repository Structure","text":"in_docker_organized/: Contains the primary source code for simulations.\nmain_create_phantom_can.jl: Entry point for Can Phantom generation.\nmain_create_phantom_ionic_chamber.jl: Entry point for Ionic Chamber generation.\ngeometry_utils.jl: Helper functions for geometry and file handling.\ntests/: Test suite and configurations.\nrun_tests.jl: Main test runner.\nconfigs/: JSON configuration files for reproducible runs.\ncomparisons/: Visual comparisons of outputs.\ndocs/: Documentation files.\n\n","category":"section"},{"location":"user_guide/#Running-the-Simulations","page":"Home","title":"Running the Simulations","text":"The simulations are run via command-line Julia scripts located in in_docker_organized/.","category":"section"},{"location":"user_guide/#Can-Phantom","page":"Home","title":"Can Phantom","text":"Generates a cylindrical container with fluid, meniscus, and optional objects.\n\nBasic Command:\n\njulia in_docker_organized/main_create_phantom_can.jl <dims> <radon> <var_spacing> <uuid> <random> <smooth> <noise> [json_path]\n\nExample:\n\n# Generate a 128x128x128 phantom, no radon transform, random parameters\njulia in_docker_organized/main_create_phantom_can.jl 128x128x128 false false my-run-001 true false 0.0","category":"section"},{"location":"user_guide/#Ionic-Chamber-Phantom","page":"Home","title":"Ionic Chamber Phantom","text":"Generates a complex multi-layered electrode structure.\n\nBasic Command:\n\njulia in_docker_organized/main_create_phantom_ionic_chamber.jl <dims> <radon> <var_spacing> <uuid> <random> <smooth> <noise> [json_path]\n\nExample:\n\n# Generate from a specific JSON configuration\njulia in_docker_organized/main_create_phantom_ionic_chamber.jl 32x32x32 false false my-run-002 false false 0.0 tests/configs/ionic_chamber.json\n\n","category":"section"},{"location":"user_guide/#Configuration","page":"Home","title":"Configuration","text":"","category":"section"},{"location":"user_guide/#Command-Line-Arguments","page":"Home","title":"Command Line Arguments","text":"Position Name Type Description\n1 dims String Dimensions format NxMxD (e.g., 128x128x128).\n2 add_radon Bool true to compute Radon transform (projections).\n3 variable_spacing Bool Adjusts voxel spacing dynamically (mostly for Ionic Chamber).\n4 uuid String Unique run identifier used for output folder naming.\n5 randomize Bool true to randomize parameters (ignored if JSON provided).\n6 add_smooth Bool true to apply Gaussian smoothing to the final image.\n7 additive_noise Float Magnitude of Gaussian noise to add (e.g., 0.1).\n8 json_path String (Optional) Path to a JSON config file. Overrides randomize.","category":"section"},{"location":"user_guide/#JSON-Configuration","page":"Home","title":"JSON Configuration","text":"For reproducible research and testing, define parameters in a JSON file.\n\nSample Can Config (tests/configs/can_phantom.json):\n\n{\n    \"center_cylinder\": [0.0, 0.0, 0.0],\n    \"bigger_cyl_size\": [3.0, 3.0, 8.0],\n    \"cylinder_wall_thickness\": 0.1,\n    \"rounded_bottom\": true,\n    \"density_inside\": 0.5,\n    \"dual_phase_percentage\": 0.5\n}\n\nSample Ionic Chamber Config (tests/configs/ionic_chamber_lolipop.json):\n\n{\n    \"lolipop_like\": true,\n    \"total_len\": 3.5,\n    \"graphite_density\": 1.0,\n    \"dims\": [64, 64, 64]\n}\n\n","category":"section"},{"location":"user_guide/#Testing-and-Verification","page":"Home","title":"Testing & Verification","text":"The repository includes a robust test suite to verify that code changes do not break the physics or geometry of the phantoms.","category":"section"},{"location":"user_guide/#Running-Tests","page":"Home","title":"Running Tests","text":"To run the full test suite (using small 32x32x32 volumes):\n\njulia tests/run_tests.jl","category":"section"},{"location":"user_guide/#Verification-Visualization","page":"Home","title":"Verification Visualization","text":"To visually inspect changes against a known reference, use the visualization tool:\n\npython3 tests/visualize_comparison.py\n\nThis script looks for output in tests/vis_out_ref and compares it against tests/vis_out_orig (if generated), saving difference images to tests/comparisons/.","category":"section"},{"location":"user_guide/#Environment-Variables-for-Testing","page":"Home","title":"Environment Variables for Testing","text":"SKIP_WANDB=true: Disables Weights & Biases logging (useful for local testing).\nSKIP_UPLOAD=true: Disables gcloud upload.\nFIXED_UUIDS=1: Forces deterministic UUIDs for reproducible filenames.\nSAVE_OUTPUTS_TO=<path>: Copies generated artifacts to a specified directory instead of deleting them.\n\n","category":"section"},{"location":"user_guide/#Output-Artifacts","page":"Home","title":"Output Artifacts","text":"The simulation generates a folder named with the uuid containing:\n\n*.nii.gz: NIfTI format volumes.\nexample_can.nii.gz / ionic_chamber.nii.gz: The final phantom.\nfluid_mask.nii.gz: Binary mask of the fluid volume.\n*mask.nii.gz: Masks for internal components (balls, pipes, etc.).\nargss.json: A log of the full parameter set used for generation.\nDICOM/: (If nii2dcm is installed) Directory containing DICOM slices and SEG objects.\n\n","category":"section"},{"location":"user_guide/#Troubleshooting","page":"Home","title":"Troubleshooting","text":"nii2dcm not found: The scripts check for this tool. If missing, a warning is printed, and DICOM conversion is skipped. The NIfTI files are still generated.\nWandB errors: Ensure you are logged in (wandb login) or use SKIP_WANDB=true.\nPackage loading errors: Run julia tests/setup_env.jl to ensure the registry and ImagePhantoms are correctly configured.","category":"section"},{"location":"workflow_summary/#Synthetic-Tomographic-Data-Generation-Workflow","page":"Workflow Summary","title":"Synthetic Tomographic Data Generation Workflow","text":"","category":"section"},{"location":"workflow_summary/#Overview","page":"Workflow Summary","title":"Overview","text":"This repository is designed for the generation of synthetic tomographic data for metrology purposes in industrial computed tomography (CT). It simulates complex 3D phantoms, performs CT projection (Radon transform), and saves the data in various formats (HDF5, NIfTI, DICOM) for further analysis and reconstruction.\n\nThe core logic is implemented in Julia, leveraging packages like ImagePhantoms, Sinograms, and ImageGeoms. Python scripts are used for specific tasks like DICOM conversion and inverse Radon transform approximations.","category":"section"},{"location":"workflow_summary/#Main-Workflows","page":"Workflow Summary","title":"Main Workflows","text":"There are two primary workflows for generating phantoms:","category":"section"},{"location":"workflow_summary/#1.-Can-Phantom-Generation","page":"Workflow Summary","title":"1. Can Phantom Generation","text":"Simulates a cylindrical container (\"can\") filled with fluid(s) and containing various objects.\n\nScript: in_docker_organized/main_create_phantom_can.jl\n\nKey Features:\n\nContainer: A cylindrical can with configurable dimensions, wall thickness, and bottom curvature (flat or rounded).\nContents:\nFluids: Single or dual-phase fluids with configurable densities and meniscus.\nObjects: Pipes, dispensers, and spherical \"balls\" floating in the fluid.\nDefects: Simulated by placing objects or modifying densities.\nGeometry: Defined using constructive solid geometry (CSG) principles with cylinders, ellipsoids, and half-spheres.\n\nWorkflow Steps:\n\nConfiguration: parameters are read from command-line arguments or a JSON file.\nPhantom Creation: random_can or json_based_can functions generate the 3D phantom based on the configuration.\nVolume Calculation: Analytical and numerical volumes of the fluid are calculated for metrology verification.\nProjection: (Optional) CT projections are generated using get_CTFAN_proj.\nOutput:\nPhantom and masks are saved as NIfTI files.\nDICOM SEG (Segmentation) objects are created.\nData is zipped and uploaded to Google Cloud Storage.","category":"section"},{"location":"workflow_summary/#2.-Ionic-Chamber-Phantom-Generation","page":"Workflow Summary","title":"2. Ionic Chamber Phantom Generation","text":"Simulates an ionic chamber, a device used for measuring ionizing radiation, which has a complex internal structure.\n\nScript: in_docker_organized/main_create_phantom_ionic_chamber.jl\n\nKey Features:\n\nStructure: A multi-layered cylindrical device with electrodes, insulation, and housing.\nComponents:\nCentral Electrode: Copper or graphite.\nInsulation: Polyethylene layers.\nShielding: Aluminum and graphite layers.\nAir Cavity: Defined by the gap between electrodes and housing.\nVariations: Supports different chamber tip shapes:\nSquare top\nBall-like (spherical)\nLollipop-like (flat head)\nRounded top (standard)\n\nWorkflow Steps:\n\nConfiguration: Parameters are generated randomly or read from a JSON file.\nPhantom Creation: create_ionic_chamber_phantom constructs the 3D volume layer by layer.\nVolume Calculation: Air cavity volume is calculated analytically and numerically.\nProjection: (Optional) CT projections are generated.\nOutput:\nPhantom and component masks are saved as NIfTI and DICOM.\nParameters are saved to JSON.\nData is zipped and uploaded to Google Cloud Storage.","category":"section"},{"location":"workflow_summary/#Configuration","page":"Workflow Summary","title":"Configuration","text":"","category":"section"},{"location":"workflow_summary/#Command-Line-Arguments","page":"Workflow Summary","title":"Command Line Arguments","text":"Both main scripts accept command-line arguments to control the simulation.\n\nExample for Can Phantom:\n\njulia in_docker_organized/main_create_phantom_can.jl <dims> <add_radon> <variable_spacing> <uuid> <randomize> <add_smooth> <additive_noise> [json_path]\n\ndims: Dimensions of the output volume (e.g., \"256x256x256\").\nadd_radon: Boolean, whether to perform Radon transform.\nvariable_spacing: Boolean, (not widely used in can phantom, but present in ionic).\nuuid: Unique identifier for the run.\nrandomize: Boolean, whether to randomize parameters (if JSON not provided).\nadd_smooth: Boolean, whether to apply Gaussian smoothing.\nadditive_noise: Float, amount of noise to add.\njson_path: (Optional) Path to a JSON file with specific parameters.\n\nExample for Ionic Chamber:\n\njulia in_docker_organized/main_create_phantom_ionic_chamber.jl <dims> <add_radon> <variable_spacing> <uuid> <randomize> <add_smooth> <additive_noise> [json_path]","category":"section"},{"location":"workflow_summary/#JSON-Configuration","page":"Workflow Summary","title":"JSON Configuration","text":"For reproducible simulations, parameters can be supplied via a JSON file.","category":"section"},{"location":"workflow_summary/#Can-Phantom-Parameters","page":"Workflow Summary","title":"Can Phantom Parameters","text":"The JSON object for the can phantom allows for fine-grained control over geometry and fluids.\n\nGeometry & Positioning:\ncenter_cylinder: [x, y, z] coordinates of the can center.\nbigger_cyl_size: [radius_x, radius_y, height] of the main can body.\nspacing: [dx, dy, dz] Voxel spacing in cm.\nangle: Rotation angle of the entire object.\nCan Structure:\ncylinder_wall_thickness: Thickness of the can walls.\nrounded_bottom: true/false. If true, the can has a rounded bottom.\ncylinder_bottom_curvature, cylinder_bottom_curvature_b: Curvature parameters for the bottom.\ncylinder_top_curvature: Curvature parameter for the top.\nFluids (Critical for Metrology):\ndensity_inside: Density of the primary fluid.\ndual_phase_percentage: Ratio (0.0 - 1.0). If < 1.0, a second fluid phase is added.\ndensity_inside_b: Density of the second fluid phase.\nlen_cut: Length of the \"cut\" (meniscus tilt) at the top of the fluid.\nx_cut_angle, y_cut_angle: Tilt angles for the fluid surface (simulating a tilted can).\nmenisc_radius: Radius of the meniscus curvature.\nInternal Objects:\nadd_pipe: true/false. Adds a central pipe.\npipe_len, pipe_cross_section, pipe_density: Dimensions and density of the pipe.\nplastic_dispenser: Configuration for a dispenser mechanism.\nfirst_ball, second_ball: true/false. Adds spherical objects to the fluid.","category":"section"},{"location":"workflow_summary/#Ionic-Chamber-Parameters","page":"Workflow Summary","title":"Ionic Chamber Parameters","text":"These parameters define the multi-layered structure of the chamber.\n\nChamber Type:\nsquare_top: true/false. Flat top.\nball_like: true/false. Spherical top.\nlolipop_like: true/false. Flat head with thin stem.\nrounded_top: true/false. Standard rounded top.\nnew_flat_sizes: true/false. Uses standardized dimensions (see rand_ver).\nrand_ver: Integer (1-3). Selects specific standard size presets if new_flat_sizes is true.\nDimensions:\ntotal_len: Total length of the chamber.\nbase_len: Length of the base/stem.\nmain_radius: Outer radius of the main chamber.\nair_thickness: Thickness of the air cavity (gap between electrodes).\nMaterial Densities:\ngraphite_density, copper_density, aluminium_density, insulation_density.\nInternal Components:\ncopper_radius, graphite_electrode_radius: Radii of electrodes.\ninner_insluation_thickness, outer_insluation_thickness: Thickness of insulation layers.\naluminium_inner_thicness, aluminium_outer_thicness: Thickness of shielding.\nadd_spiral: true/false. Adds a spiral structure to the outer aluminum layer.","category":"section"},{"location":"workflow_summary/#External-Services-Configuration","page":"Workflow Summary","title":"External Services Configuration","text":"","category":"section"},{"location":"workflow_summary/#WandB-(Weights-and-Biases)","page":"Workflow Summary","title":"WandB (Weights & Biases)","text":"The scripts use wandb for logging run information.\n\nProject Name: Hardcoded as \"synth\".\nAuthentication: The script does not explicitly set the API key. You must ensure the environment is authenticated:\nRun wandb login <your_api_key> in the terminal before execution.\nOr set the WANDB_API_KEY environment variable.","category":"section"},{"location":"workflow_summary/#Google-Cloud-Storage","page":"Workflow Summary","title":"Google Cloud Storage","text":"The scripts automatically upload results to Google Cloud Storage buckets.\n\nBucket URLs:\nCan Phantom: gs://metro_tk_kplayground/cansx128/\nIonic Chamber: gs://metro_tk_kplayground/ionic-chambersx128/\nConfiguration:\nThe gcloud CLI tool must be installed and authenticated in the environment.\nThe user/service account must have write permissions to the specified buckets.\nTo modify the bucket URL, you must edit the command string in the get_random_can_uploaded (can) or get_random_chamber (ionic) functions.\nSkipping Uploads: Set the environment variable SKIP_UPLOAD=true to bypass this step (useful for local testing).","category":"section"},{"location":"workflow_summary/#Output-Structure","page":"Workflow Summary","title":"Output Structure","text":"The output is typically organized in a temporary folder structure labeled with the UUID, then zipped and uploaded.\n\n*.nii.gz: 3D volumetric data (NIfTI format).\nexample_can.nii.gz / ionic_chamber.nii.gz: The main phantom image.\n*_mask.nii.gz: Binary masks for specific components (fluid, pipe, air, etc.).\nDICOM/: Directory containing DICOM slices and DICOM SEG objects.\nargss.json / ionic_chamber_params.json: Configuration parameters used for generation.\n*.h5: (In some versions) HDF5 files containing raw data and metadata.","category":"section"},{"location":"workflow_summary/#Dependencies","page":"Workflow Summary","title":"Dependencies","text":"Julia: ImagePhantoms, Sinograms, ImageGeoms, MIRTjim, Unitful, HDF5, PyCall.\nPython: SimpleITK, numpy, wandb (Weights & Biases for logging), pydicom (via nifti_to_dicom_seg.py).\nSystem: dcmtk (for nii2dcm and dcm2niix utilities).","category":"section"},{"location":"cleanup_proposals/#Proposed-Repository-Cleanup","page":"Cleanup Proposals","title":"Proposed Repository Cleanup","text":"Based on an analysis of the repository structure and file contents, the following cleanup actions are recommended to improve organization and remove redundant or obsolete files.\n\nNote: This is a proposal only. No files have been deleted.","category":"section"},{"location":"cleanup_proposals/#Files-Recommended-for-Deletion","page":"Cleanup Proposals","title":"Files Recommended for Deletion","text":"","category":"section"},{"location":"cleanup_proposals/#1.-Root-Directory-Redundancies","page":"Cleanup Proposals","title":"1. Root Directory Redundancies","text":"The following files in the root directory appear to be duplicates or older versions of files now better organized in in_docker_organized/.\n\nget_geometry_main.jl\nReason: This file is a duplicate of in_docker_organized/get_geometry_main.jl. The version in in_docker_organized/ is the one referenced in the documentation and seems to be the active one.\nAction: Delete.\ngenerate-random_can_low_res.jl\nReason: This script appears to be an older or alternative version of in_docker_organized/main_create_phantom_can.jl. It contains hardcoded API keys and less structured logic compared to the organized version.\nAction: Delete (ensure any unique logic is ported to main_create_phantom_can.jl if needed, though a quick check suggests main_create_phantom_can.jl is superior).","category":"section"},{"location":"cleanup_proposals/#2.-Temporary-and-Backup-Files","page":"Cleanup Proposals","title":"2. Temporary and Backup Files","text":"These files appear to be artifacts of development or backup copies that are no longer needed.\n\nDockerfile copy\nReason: A backup copy of a Dockerfile.\nAction: Delete.\noldDockerfileOld.txt\nReason: clearly an old backup file (\"old...Old.txt\").\nAction: Delete.\ntest.py\nReason: Contains only import numpy as np. It serves no functional purpose.\nAction: Delete.\ndownload_data.py\nReason: Scripts for downloading \"Task09_Spleen\" dataset (MONAI), which seems unrelated to the synthetic geometric phantom generation which is the core purpose of this repo.\nAction: Delete (unless there is a hidden dependency on this external data, which seems unlikely for synthetic generation).","category":"section"},{"location":"cleanup_proposals/#Proposed-Restructuring","page":"Cleanup Proposals","title":"Proposed Restructuring","text":"To further clean up the repository, the following structural changes are proposed:\n\nMove CtFanArc_params.jl to in_docker_organized/\nReason: This file is closely related to the projection logic used by the scripts in in_docker_organized/. Keeping it in the root while other dependencies are in the subdirectory is inconsistent.\nAction: Move CtFanArc_params.jl to in_docker_organized/ and update include paths in main_create_phantom_can.jl and main_create_phantom_ionic_chamber.jl.\nRename in_docker_organized to src\nReason: in_docker_organized is a descriptive but non-standard name. src is the conventional directory for source code.\nAction: Rename directory.","category":"section"},{"location":"cleanup_proposals/#Summary-of-Actions","page":"Cleanup Proposals","title":"Summary of Actions","text":"File/Directory Recommendation Reason\nget_geometry_main.jl Delete Duplicate of in_docker_organized/get_geometry_main.jl\ngenerate-random_can_low_res.jl Delete Obsolete/Duplicate script\nDockerfile copy Delete Backup file\noldDockerfileOld.txt Delete Backup file\ntest.py Delete Empty test file\ndownload_data.py Delete Unrelated to core functionality\nCtFanArc_params.jl Move Move to source directory for consistency\nin_docker_organized/ Rename Rename to src/ for convention","category":"section"},{"location":"functions_reference/#Function-Reference","page":"Functions Reference","title":"Function Reference","text":"This document provides detailed documentation for the functions in the repository, organized by source file.","category":"section"},{"location":"functions_reference/#1.-in_docker_organized/main_create_phantom_can.jl","page":"Functions Reference","title":"1. in_docker_organized/main_create_phantom_can.jl","text":"This script is the entry point for generating \"can\" phantoms. It defines functions to create, configure, and save the phantom data.","category":"section"},{"location":"functions_reference/#json_based_can(ig,-json_path,-is_2dtrue,-is_debugfalse)","page":"Functions Reference","title":"json_based_can(ig, json_path, is_2d=true, is_debug=false)","text":"Generates a \"can\" phantom based on parameters loaded from a JSON file.\n\nArguments:\nig: ImageGeom object defining the image geometry (dimensions, spacing).\njson_path: Path to the JSON configuration file.\nis_2d: Boolean, if true, forces certain angles to 0 (for 2D slice generation).\nis_debug: Boolean, enables debug print statements.\nReturns: A tuple containing:\nvol: Dictionary with volume information (e.g., fluid volume).\nargs: List of tuples representing the phantom parameters.\ndensity_map: Dictionary mapping object names to their densities.\nname_type_list: List of object names and types.\nBoolean flags for geometry features (double bottom, rounded bottom, etc.).","category":"section"},{"location":"functions_reference/#random_can(ig,-image_size_cm,-is_2d,-seed,-spacing,-is_debugfalse)","page":"Functions Reference","title":"random_can(ig, image_size_cm, is_2d, seed, spacing, is_debug=false)","text":"Generates a \"can\" phantom with randomized parameters within defined constraints.\n\nArguments:\nig: ImageGeom object.\nimage_size_cm: Tuple of image dimensions in cm.\nis_2d: Boolean for 2D mode.\nseed: Integer seed for random number generation.\nspacing: Voxel spacing (dx, dy, dz).\nis_debug: Boolean for debug output.\nReturns: Same structure as json_based_can.","category":"section"},{"location":"functions_reference/#get_cylinder_bool_mask(ob_el)","page":"Functions Reference","title":"get_cylinder_bool_mask(ob_el)","text":"Converts a cylinder object (or list of objects) into a boolean mask.\n\nArguments: ob_el: Phantom object(s).\nReturns: 3D BitArray (mask).","category":"section"},{"location":"functions_reference/#get_half_s_bool(ob_el)","page":"Functions Reference","title":"get_half_s_bool(ob_el)","text":"Converts a half-sphere object into a boolean mask.\n\nArguments: ob_el: Phantom object(s).\nReturns: 3D BitArray (mask).","category":"section"},{"location":"functions_reference/#get_temp_folder()","page":"Functions Reference","title":"get_temp_folder()","text":"Creates a temporary directory for storing intermediate files.\n\nReturns: Path to the temporary directory.","category":"section"},{"location":"functions_reference/#save_args(args,-vol,-main_folder)","page":"Functions Reference","title":"save_args(args, vol, main_folder)","text":"Saves the generation arguments and volume data to a argss.json file in the specified folder.\n\nArguments:\nargs: List of parameter tuples.\nvol: Volume data.\nmain_folder: Output directory path.","category":"section"},{"location":"functions_reference/#create_boolean_density_dict(name_type_list,-density_map)","page":"Functions Reference","title":"create_boolean_density_dict(name_type_list, density_map)","text":"Constructs a dictionary of phantom objects with their boolean masks and density-scaled float masks.\n\nArguments:\nname_type_list: List of (name, object, type) tuples.\ndensity_map: Dictionary of densities.\nReturns: Dictionary where keys are object names and values are tuples (bool_mask, float_mask, original_object).","category":"section"},{"location":"functions_reference/#add_noise_at(phantoms_dict,-key,-density_map)","page":"Functions Reference","title":"add_noise_at(phantoms_dict, key, density_map)","text":"Adds Gaussian noise to a specific object's region in the phantom.\n\nArguments:\nphantoms_dict: Dictionary of phantom objects.\nkey: Key of the object to add noise to.\ndensity_map: Density map.\nReturns: Float array with noise added to the object's region.","category":"section"},{"location":"functions_reference/#get_random_can_uploaded(is_2d,-seed,-uuidnothing)","page":"Functions Reference","title":"get_random_can_uploaded(is_2d, seed, uuid=nothing)","text":"Main workflow function to generate, save, and upload a random can phantom.\n\nArguments:\nis_2d: Boolean flag.\nseed: Random seed.\nuuid: Unique identifier (optional).\nReturns: Tuple (numerical_vol, analytical_vol, fluid_volume_numerical_my) representing different volume calculations.","category":"section"},{"location":"functions_reference/#calculate_and_save_fluid_volume(seed,-is_2dfalse,-uuidnothing)","page":"Functions Reference","title":"calculate_and_save_fluid_volume(seed, is_2d=false, uuid=nothing)","text":"Wrapper function that calls get_random_can_uploaded.","category":"section"},{"location":"functions_reference/#2.-in_docker_organized/main_create_phantom_ionic_chamber.jl","page":"Functions Reference","title":"2. in_docker_organized/main_create_phantom_ionic_chamber.jl","text":"This script generates \"ionic chamber\" phantoms.","category":"section"},{"location":"functions_reference/#cylinder_interval(c_z,-l_z)","page":"Functions Reference","title":"cylinder_interval(c_z, l_z)","text":"Helper to calculate the z-range of a cylinder.\n\nReturns: (z_start, z_end).","category":"section"},{"location":"functions_reference/#overlaps(c1,-l1,-c2,-l2)","page":"Functions Reference","title":"overlaps(c1, l1, c2, l2)","text":"Checks if two z-intervals overlap.\n\nReturns: Boolean.","category":"section"},{"location":"functions_reference/#compute_adjusted_density(new_desired,-new_z,-new_lz,-existing)","page":"Functions Reference","title":"compute_adjusted_density(new_desired, new_z, new_lz, existing)","text":"Calculates the effective density for a new cylinder to account for overlaps with existing cylinders (density superposition).\n\nReturns: Adjusted density value.","category":"section"},{"location":"functions_reference/#create_cylinder(base_x,-base_y,-base_bottom_z,-spec,-angle,-name)","page":"Functions Reference","title":"create_cylinder(base_x, base_y, base_bottom_z, spec, angle, name)","text":"Creates a cylinder parameter NamedTuple from a specification dictionary.\n\nReturns: NamedTuple with cylinder parameters.","category":"section"},{"location":"functions_reference/#adjust_densities!(cylinders)","page":"Functions Reference","title":"adjust_densities!(cylinders)","text":"Iteratively adjusts the densities of a list of cylinders to ensure the final superposition matches the desired densities.\n\nReturns: Vector of adjusted cylinder NamedTuples.","category":"section"},{"location":"functions_reference/#build_image(base_params,-specs,-angle,-spacing,-dims)","page":"Functions Reference","title":"build_image(base_params, specs, angle, spacing, dims)","text":"Constructs the full phantom image from base parameters and component specifications.\n\nReturns: Tuple containing (cylinders_prim, named_res, cylinder_densities, vol_res).","category":"section"},{"location":"functions_reference/#create_ionic_chamber_phantom(params)","page":"Functions Reference","title":"create_ionic_chamber_phantom(params)","text":"Main function to generate the ionic chamber phantom. It determines the specific geometry (square top, ball-like, etc.) and assembles the components.\n\nArguments: params: Dictionary of parameters.\nReturns: Tuple containing the final image array, raw image, masks, and volume data.","category":"section"},{"location":"functions_reference/#save_ionic_chamber_params(params,-filename)","page":"Functions Reference","title":"save_ionic_chamber_params(params, filename)","text":"Saves the parameter dictionary to a JSON file.","category":"section"},{"location":"functions_reference/#json_params(args_json_path,-uuidnothing,-dims(128,-128,-128))","page":"Functions Reference","title":"json_params(args_json_path, uuid=nothing, dims=(128, 128, 128))","text":"Loads parameters from a JSON file, filling in defaults where necessary.","category":"section"},{"location":"functions_reference/#generate_random_params(uuid,-dims,-randomizetrue,-variable_spacingfalse)","page":"Functions Reference","title":"generate_random_params(uuid, dims, randomize=true, variable_spacing=false)","text":"Generates a random parameter set for an ionic chamber, selecting a random type (square top, ball-like, etc.) and randomizing dimensions.\n\nReturns: Parameter dictionary.","category":"section"},{"location":"functions_reference/#get_random_chamber(dims,-uuid,-temp_fold,-variable_spacing,-randomize)","page":"Functions Reference","title":"get_random_chamber(dims, uuid, temp_fold, variable_spacing, randomize)","text":"Main workflow function to generate, save, and upload an ionic chamber phantom.","category":"section"},{"location":"functions_reference/#3.-in_docker_organized/get_geometry_main.jl","page":"Functions Reference","title":"3. in_docker_organized/get_geometry_main.jl","text":"Contains the geometry definitions for the \"can\" phantom.","category":"section"},{"location":"functions_reference/#ionic_chamber_p(...)","page":"Functions Reference","title":"ionic_chamber_p(...)","text":"Defines the geometry of a parameterized ionic chamber using basic shapes. (Note: This seems to be an alternative or older implementation compared to the main script).","category":"section"},{"location":"functions_reference/#empty_cylinder_with_half_sphere_bottom_p(...)","page":"Functions Reference","title":"empty_cylinder_with_half_sphere_bottom_p(...)","text":"Constructs the components of a \"can\" phantom. This is a complex function that defines:\n\nThe main cylinder body.\nThe bottom (flat or rounded with half-spheres).\nThe fluid (single or dual phase) with meniscus.\nThe cut plane (tilt) at the top of the fluid.\nInternal objects (pipe, dispenser).\nDefects or \"cuts\".\nReturns: A tuple containing the list of objects, volume dictionary, and individual component masks.","category":"section"},{"location":"functions_reference/#volume_of_elliptical_cylinder(pipe_cross_section,-overlay_length)","page":"Functions Reference","title":"volume_of_elliptical_cylinder(pipe_cross_section, overlay_length)","text":"Calculates the volume of an elliptical cylinder.","category":"section"},{"location":"functions_reference/#4.-in_docker_organized/geometry_utils.jl","page":"Functions Reference","title":"4. in_docker_organized/geometry_utils.jl","text":"Utility functions for image manipulation and saving.","category":"section"},{"location":"functions_reference/#matrix_from_axis_angle(a)","page":"Functions Reference","title":"matrix_from_axis_angle(a)","text":"Computes a rotation matrix from an axis-angle representation.","category":"section"},{"location":"functions_reference/#resample(image,-transform)","page":"Functions Reference","title":"resample(image, transform)","text":"Resamples a SimpleITK image using a given transform.","category":"section"},{"location":"functions_reference/#rotation3d(image,-axis,-theta)","page":"Functions Reference","title":"rotation3d(image, axis, theta)","text":"Rotates a 3D image around a specific axis by theta degrees.","category":"section"},{"location":"functions_reference/#save_sitk_image_as_dicom(img,-output_folder)","page":"Functions Reference","title":"save_sitk_image_as_dicom(img, output_folder)","text":"Saves a SimpleITK image as a series of DICOM files. Uses nii2dcm utility.","category":"section"},{"location":"functions_reference/#get_per_slice_reconstruction(arr)","page":"Functions Reference","title":"get_per_slice_reconstruction(arr)","text":"Performs a slice-by-slice reconstruction (inverse Radon transform) using skimage.transform.iradon.","category":"section"},{"location":"functions_reference/#save_2d_sitk_image_as_dicom(immm,-output_path)","page":"Functions Reference","title":"save_2d_sitk_image_as_dicom(immm, output_path)","text":"Saves a 2D SimpleITK image as a DICOM file, handling intensity scaling.","category":"section"},{"location":"functions_reference/#save_nifti_with_meta(arr,-cast_to_uint8,-spacing,-output_path)","page":"Functions Reference","title":"save_nifti_with_meta(arr, cast_to_uint8, spacing, output_path)","text":"Saves an array as a NIfTI file with specified metadata (spacing, direction, origin).","category":"section"},{"location":"functions_reference/#save_mask_as_nifti(mask,-output_path,-spacing)","page":"Functions Reference","title":"save_mask_as_nifti(mask, output_path, spacing)","text":"Wrapper to save a boolean mask as a NIfTI file.","category":"section"},{"location":"functions_reference/#convert_nifti_to_dicom_seg(nifti_path,-reference_dicom_path,-output_folder,-reference_nifti_path\"\")","page":"Functions Reference","title":"convert_nifti_to_dicom_seg(nifti_path, reference_dicom_path, output_folder, reference_nifti_path=\"\")","text":"Converts a NIfTI mask to DICOM-SEG format by calling a Python script (nifti_to_dicom_seg.py).","category":"section"},{"location":"functions_reference/#move_image(array,-axis,-distance,-direction,-spacing)","page":"Functions Reference","title":"move_image(array, axis, distance, direction, spacing)","text":"Shifts a binary image along a specified axis by a given distance (in cm).","category":"section"},{"location":"functions_reference/#5.-in_docker_organized/volume_integration.jl","page":"Functions Reference","title":"5. in_docker_organized/volume_integration.jl","text":"Functions for analytical volume calculation of the fluid in the can phantom.","category":"section"},{"location":"functions_reference/#compute_fluid_volume_in_can(phantoms_dict,-spacing,-first_ball,-second_ball,-rounded_bottom,-params)","page":"Functions Reference","title":"compute_fluid_volume_in_can(phantoms_dict, spacing, first_ball, second_ball, rounded_bottom, params)","text":"Calculates the fluid volume using both numerical (sum of voxels) and analytical (geometric formulas) methods. It accounts for:\n\nBase cylinder volume.\nTop cut plane (tilt).\nBottom geometry (rounded or flat).\nSubtracted objects (balls, pipe overlap).\nReturns: Tuple (numerical_vol, analytical_vol).","category":"section"},{"location":"functions_reference/#compute_accurate_fluid_volume(phantoms_dict,-spacing,-first_ball,-second_ball,-rounded_bottom,-params,-ig)","page":"Functions Reference","title":"compute_accurate_fluid_volume(phantoms_dict, spacing, first_ball, second_ball, rounded_bottom, params, ig)","text":"A more precise version of volume calculation, handling complex interactions between components.","category":"section"},{"location":"functions_reference/#compute_accurate_fluid_volume_fixed(...)","page":"Functions Reference","title":"compute_accurate_fluid_volume_fixed(...)","text":"Fixed version of the accurate volume calculation logic.","category":"section"},{"location":"functions_reference/#6.-CtFanArc_params.jl","page":"Functions Reference","title":"6. CtFanArc_params.jl","text":"Defines CT geometry and projection functions.","category":"section"},{"location":"functions_reference/#get_CTFAN_proj(ob,-is_high_resfalse)","page":"Functions Reference","title":"get_CTFAN_proj(ob, is_high_res=false)","text":"Configures a Fan Beam CT geometry and generates projections (sinogram) for a given object.\n\nArguments:\nob: Phantom object(s) to project.\nis_high_res: Boolean, selects between standard and high-resolution geometry settings.\nReturns: Tuple (proj_arc, rg), where proj_arc is the projection data and rg is the geometry object.","category":"section"}]
}
