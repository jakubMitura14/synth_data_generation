<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Workflow Summary · Synthetic Tomography</title><meta name="title" content="Workflow Summary · Synthetic Tomography"/><meta property="og:title" content="Workflow Summary · Synthetic Tomography"/><meta property="twitter:title" content="Workflow Summary · Synthetic Tomography"/><meta name="description" content="Documentation for Synthetic Tomography."/><meta property="og:description" content="Documentation for Synthetic Tomography."/><meta property="twitter:description" content="Documentation for Synthetic Tomography."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../user_guide/">Synthetic Tomography</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../user_guide/">Home</a></li><li class="is-active"><a class="tocitem" href>Workflow Summary</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Main-Workflows"><span>Main Workflows</span></a></li><li><a class="tocitem" href="#Configuration"><span>Configuration</span></a></li><li><a class="tocitem" href="#External-Services-Configuration"><span>External Services Configuration</span></a></li><li><a class="tocitem" href="#Output-Structure"><span>Output Structure</span></a></li><li><a class="tocitem" href="#Dependencies"><span>Dependencies</span></a></li></ul></li><li><a class="tocitem" href="../functions_reference/">Functions Reference</a></li><li><a class="tocitem" href="../cleanup_proposals/">Cleanup Proposals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Workflow Summary</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Workflow Summary</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jakubMitura14/synth_data_generation" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jakubMitura14/synth_data_generation/blob/main/docs/src/workflow_summary.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Synthetic-Tomographic-Data-Generation-Workflow"><a class="docs-heading-anchor" href="#Synthetic-Tomographic-Data-Generation-Workflow">Synthetic Tomographic Data Generation Workflow</a><a id="Synthetic-Tomographic-Data-Generation-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Synthetic-Tomographic-Data-Generation-Workflow" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This repository is designed for the generation of synthetic tomographic data for metrology purposes in industrial computed tomography (CT). It simulates complex 3D phantoms, performs CT projection (Radon transform), and saves the data in various formats (HDF5, NIfTI, DICOM) for further analysis and reconstruction.</p><p>The core logic is implemented in Julia, leveraging packages like <code>ImagePhantoms</code>, <code>Sinograms</code>, and <code>ImageGeoms</code>. Python scripts are used for specific tasks like DICOM conversion and inverse Radon transform approximations.</p><h2 id="Main-Workflows"><a class="docs-heading-anchor" href="#Main-Workflows">Main Workflows</a><a id="Main-Workflows-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Workflows" title="Permalink"></a></h2><p>There are two primary workflows for generating phantoms:</p><h3 id="1.-Can-Phantom-Generation"><a class="docs-heading-anchor" href="#1.-Can-Phantom-Generation">1. Can Phantom Generation</a><a id="1.-Can-Phantom-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Can-Phantom-Generation" title="Permalink"></a></h3><p>Simulates a cylindrical container (&quot;can&quot;) filled with fluid(s) and containing various objects.</p><p><strong>Script:</strong> <code>in_docker_organized/main_create_phantom_can.jl</code></p><p><strong>Key Features:</strong></p><ul><li><strong>Container:</strong> A cylindrical can with configurable dimensions, wall thickness, and bottom curvature (flat or rounded).</li><li><strong>Contents:</strong><ul><li><strong>Fluids:</strong> Single or dual-phase fluids with configurable densities and meniscus.</li><li><strong>Objects:</strong> Pipes, dispensers, and spherical &quot;balls&quot; floating in the fluid.</li><li><strong>Defects:</strong> Simulated by placing objects or modifying densities.</li></ul></li><li><strong>Geometry:</strong> Defined using constructive solid geometry (CSG) principles with cylinders, ellipsoids, and half-spheres.</li></ul><p><strong>Workflow Steps:</strong></p><ol><li><strong>Configuration:</strong> parameters are read from command-line arguments or a JSON file.</li><li><strong>Phantom Creation:</strong> <code>random_can</code> or <code>json_based_can</code> functions generate the 3D phantom based on the configuration.</li><li><strong>Volume Calculation:</strong> Analytical and numerical volumes of the fluid are calculated for metrology verification.</li><li><strong>Projection:</strong> (Optional) CT projections are generated using <code>get_CTFAN_proj</code>.</li><li><strong>Output:</strong><ul><li>Phantom and masks are saved as NIfTI files.</li><li>DICOM SEG (Segmentation) objects are created.</li><li>Data is zipped and uploaded to Google Cloud Storage.</li></ul></li></ol><h3 id="2.-Ionic-Chamber-Phantom-Generation"><a class="docs-heading-anchor" href="#2.-Ionic-Chamber-Phantom-Generation">2. Ionic Chamber Phantom Generation</a><a id="2.-Ionic-Chamber-Phantom-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Ionic-Chamber-Phantom-Generation" title="Permalink"></a></h3><p>Simulates an ionic chamber, a device used for measuring ionizing radiation, which has a complex internal structure.</p><p><strong>Script:</strong> <code>in_docker_organized/main_create_phantom_ionic_chamber.jl</code></p><p><strong>Key Features:</strong></p><ul><li><strong>Structure:</strong> A multi-layered cylindrical device with electrodes, insulation, and housing.</li><li><strong>Components:</strong><ul><li><strong>Central Electrode:</strong> Copper or graphite.</li><li><strong>Insulation:</strong> Polyethylene layers.</li><li><strong>Shielding:</strong> Aluminum and graphite layers.</li><li><strong>Air Cavity:</strong> Defined by the gap between electrodes and housing.</li></ul></li><li><strong>Variations:</strong> Supports different chamber tip shapes:<ul><li>Square top</li><li>Ball-like (spherical)</li><li>Lollipop-like (flat head)</li><li>Rounded top (standard)</li></ul></li></ul><p><strong>Workflow Steps:</strong></p><ol><li><strong>Configuration:</strong> Parameters are generated randomly or read from a JSON file.</li><li><strong>Phantom Creation:</strong> <code>create_ionic_chamber_phantom</code> constructs the 3D volume layer by layer.</li><li><strong>Volume Calculation:</strong> Air cavity volume is calculated analytically and numerically.</li><li><strong>Projection:</strong> (Optional) CT projections are generated.</li><li><strong>Output:</strong><ul><li>Phantom and component masks are saved as NIfTI and DICOM.</li><li>Parameters are saved to JSON.</li><li>Data is zipped and uploaded to Google Cloud Storage.</li></ul></li></ol><h2 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h2><h3 id="Command-Line-Arguments"><a class="docs-heading-anchor" href="#Command-Line-Arguments">Command Line Arguments</a><a id="Command-Line-Arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Command-Line-Arguments" title="Permalink"></a></h3><p>Both main scripts accept command-line arguments to control the simulation.</p><p><strong>Example for Can Phantom:</strong></p><pre><code class="language-bash hljs">julia in_docker_organized/main_create_phantom_can.jl &lt;dims&gt; &lt;add_radon&gt; &lt;variable_spacing&gt; &lt;uuid&gt; &lt;randomize&gt; &lt;add_smooth&gt; &lt;additive_noise&gt; [json_path]</code></pre><ul><li><code>dims</code>: Dimensions of the output volume (e.g., &quot;256x256x256&quot;).</li><li><code>add_radon</code>: Boolean, whether to perform Radon transform.</li><li><code>variable_spacing</code>: Boolean, (not widely used in can phantom, but present in ionic).</li><li><code>uuid</code>: Unique identifier for the run.</li><li><code>randomize</code>: Boolean, whether to randomize parameters (if JSON not provided).</li><li><code>add_smooth</code>: Boolean, whether to apply Gaussian smoothing.</li><li><code>additive_noise</code>: Float, amount of noise to add.</li><li><code>json_path</code>: (Optional) Path to a JSON file with specific parameters.</li></ul><p><strong>Example for Ionic Chamber:</strong></p><pre><code class="language-bash hljs">julia in_docker_organized/main_create_phantom_ionic_chamber.jl &lt;dims&gt; &lt;add_radon&gt; &lt;variable_spacing&gt; &lt;uuid&gt; &lt;randomize&gt; &lt;add_smooth&gt; &lt;additive_noise&gt; [json_path]</code></pre><h3 id="JSON-Configuration"><a class="docs-heading-anchor" href="#JSON-Configuration">JSON Configuration</a><a id="JSON-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#JSON-Configuration" title="Permalink"></a></h3><p>For reproducible simulations, parameters can be supplied via a JSON file.</p><h4 id="Can-Phantom-Parameters"><a class="docs-heading-anchor" href="#Can-Phantom-Parameters">Can Phantom Parameters</a><a id="Can-Phantom-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Can-Phantom-Parameters" title="Permalink"></a></h4><p>The JSON object for the can phantom allows for fine-grained control over geometry and fluids.</p><ul><li><strong>Geometry &amp; Positioning:</strong><ul><li><code>center_cylinder</code>: <code>[x, y, z]</code> coordinates of the can center.</li><li><code>bigger_cyl_size</code>: <code>[radius_x, radius_y, height]</code> of the main can body.</li><li><code>spacing</code>: <code>[dx, dy, dz]</code> Voxel spacing in cm.</li><li><code>angle</code>: Rotation angle of the entire object.</li></ul></li><li><strong>Can Structure:</strong><ul><li><code>cylinder_wall_thickness</code>: Thickness of the can walls.</li><li><code>rounded_bottom</code>: <code>true</code>/<code>false</code>. If true, the can has a rounded bottom.</li><li><code>cylinder_bottom_curvature</code>, <code>cylinder_bottom_curvature_b</code>: Curvature parameters for the bottom.</li><li><code>cylinder_top_curvature</code>: Curvature parameter for the top.</li></ul></li><li><strong>Fluids (Critical for Metrology):</strong><ul><li><code>density_inside</code>: Density of the primary fluid.</li><li><code>dual_phase_percentage</code>: Ratio (0.0 - 1.0). If &lt; 1.0, a second fluid phase is added.</li><li><code>density_inside_b</code>: Density of the second fluid phase.</li><li><code>len_cut</code>: Length of the &quot;cut&quot; (meniscus tilt) at the top of the fluid.</li><li><code>x_cut_angle</code>, <code>y_cut_angle</code>: Tilt angles for the fluid surface (simulating a tilted can).</li><li><code>menisc_radius</code>: Radius of the meniscus curvature.</li></ul></li><li><strong>Internal Objects:</strong><ul><li><code>add_pipe</code>: <code>true</code>/<code>false</code>. Adds a central pipe.</li><li><code>pipe_len</code>, <code>pipe_cross_section</code>, <code>pipe_density</code>: Dimensions and density of the pipe.</li><li><code>plastic_dispenser</code>: Configuration for a dispenser mechanism.</li><li><code>first_ball</code>, <code>second_ball</code>: <code>true</code>/<code>false</code>. Adds spherical objects to the fluid.</li></ul></li></ul><h4 id="Ionic-Chamber-Parameters"><a class="docs-heading-anchor" href="#Ionic-Chamber-Parameters">Ionic Chamber Parameters</a><a id="Ionic-Chamber-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Ionic-Chamber-Parameters" title="Permalink"></a></h4><p>These parameters define the multi-layered structure of the chamber.</p><ul><li><strong>Chamber Type:</strong><ul><li><code>square_top</code>: <code>true</code>/<code>false</code>. Flat top.</li><li><code>ball_like</code>: <code>true</code>/<code>false</code>. Spherical top.</li><li><code>lolipop_like</code>: <code>true</code>/<code>false</code>. Flat head with thin stem.</li><li><code>rounded_top</code>: <code>true</code>/<code>false</code>. Standard rounded top.</li><li><code>new_flat_sizes</code>: <code>true</code>/<code>false</code>. Uses standardized dimensions (see <code>rand_ver</code>).</li><li><code>rand_ver</code>: Integer (1-3). Selects specific standard size presets if <code>new_flat_sizes</code> is true.</li></ul></li><li><strong>Dimensions:</strong><ul><li><code>total_len</code>: Total length of the chamber.</li><li><code>base_len</code>: Length of the base/stem.</li><li><code>main_radius</code>: Outer radius of the main chamber.</li><li><code>air_thickness</code>: Thickness of the air cavity (gap between electrodes).</li></ul></li><li><strong>Material Densities:</strong><ul><li><code>graphite_density</code>, <code>copper_density</code>, <code>aluminium_density</code>, <code>insulation_density</code>.</li></ul></li><li><strong>Internal Components:</strong><ul><li><code>copper_radius</code>, <code>graphite_electrode_radius</code>: Radii of electrodes.</li><li><code>inner_insluation_thickness</code>, <code>outer_insluation_thickness</code>: Thickness of insulation layers.</li><li><code>aluminium_inner_thicness</code>, <code>aluminium_outer_thicness</code>: Thickness of shielding.</li><li><code>add_spiral</code>: <code>true</code>/<code>false</code>. Adds a spiral structure to the outer aluminum layer.</li></ul></li></ul><h2 id="External-Services-Configuration"><a class="docs-heading-anchor" href="#External-Services-Configuration">External Services Configuration</a><a id="External-Services-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#External-Services-Configuration" title="Permalink"></a></h2><h3 id="WandB-(Weights-and-Biases)"><a class="docs-heading-anchor" href="#WandB-(Weights-and-Biases)">WandB (Weights &amp; Biases)</a><a id="WandB-(Weights-and-Biases)-1"></a><a class="docs-heading-anchor-permalink" href="#WandB-(Weights-and-Biases)" title="Permalink"></a></h3><p>The scripts use <code>wandb</code> for logging run information.</p><ul><li><strong>Project Name:</strong> Hardcoded as <code>&quot;synth&quot;</code>.</li><li><strong>Authentication:</strong> The script does not explicitly set the API key. You must ensure the environment is authenticated:<ul><li>Run <code>wandb login &lt;your_api_key&gt;</code> in the terminal before execution.</li><li>Or set the <code>WANDB_API_KEY</code> environment variable.</li></ul></li></ul><h3 id="Google-Cloud-Storage"><a class="docs-heading-anchor" href="#Google-Cloud-Storage">Google Cloud Storage</a><a id="Google-Cloud-Storage-1"></a><a class="docs-heading-anchor-permalink" href="#Google-Cloud-Storage" title="Permalink"></a></h3><p>The scripts automatically upload results to Google Cloud Storage buckets.</p><ul><li><strong>Bucket URLs:</strong><ul><li>Can Phantom: <code>gs://metro_tk_kplayground/cansx128/</code></li><li>Ionic Chamber: <code>gs://metro_tk_kplayground/ionic-chambersx128/</code></li></ul></li><li><strong>Configuration:</strong><ul><li>The <code>gcloud</code> CLI tool must be installed and authenticated in the environment.</li><li>The user/service account must have write permissions to the specified buckets.</li><li>To modify the bucket URL, you must edit the <code>command</code> string in the <code>get_random_can_uploaded</code> (can) or <code>get_random_chamber</code> (ionic) functions.</li><li><strong>Skipping Uploads:</strong> Set the environment variable <code>SKIP_UPLOAD=true</code> to bypass this step (useful for local testing).</li></ul></li></ul><h2 id="Output-Structure"><a class="docs-heading-anchor" href="#Output-Structure">Output Structure</a><a id="Output-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Output-Structure" title="Permalink"></a></h2><p>The output is typically organized in a temporary folder structure labeled with the UUID, then zipped and uploaded.</p><ul><li><code>*.nii.gz</code>: 3D volumetric data (NIfTI format).<ul><li><code>example_can.nii.gz</code> / <code>ionic_chamber.nii.gz</code>: The main phantom image.</li><li><code>*_mask.nii.gz</code>: Binary masks for specific components (fluid, pipe, air, etc.).</li></ul></li><li><code>DICOM/</code>: Directory containing DICOM slices and DICOM SEG objects.</li><li><code>argss.json</code> / <code>ionic_chamber_params.json</code>: Configuration parameters used for generation.</li><li><code>*.h5</code>: (In some versions) HDF5 files containing raw data and metadata.</li></ul><h2 id="Dependencies"><a class="docs-heading-anchor" href="#Dependencies">Dependencies</a><a id="Dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Dependencies" title="Permalink"></a></h2><ul><li><strong>Julia:</strong> <code>ImagePhantoms</code>, <code>Sinograms</code>, <code>ImageGeoms</code>, <code>MIRTjim</code>, <code>Unitful</code>, <code>HDF5</code>, <code>PyCall</code>.</li><li><strong>Python:</strong> <code>SimpleITK</code>, <code>numpy</code>, <code>wandb</code> (Weights &amp; Biases for logging), <code>pydicom</code> (via <code>nifti_to_dicom_seg.py</code>).</li><li><strong>System:</strong> <code>dcmtk</code> (for <code>nii2dcm</code> and <code>dcm2niix</code> utilities).</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../user_guide/">« Home</a><a class="docs-footer-nextpage" href="../functions_reference/">Functions Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 19 February 2026 13:44">Thursday 19 February 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
